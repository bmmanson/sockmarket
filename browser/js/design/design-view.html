<style>

body {
	background: white;
	font-family: sans-serif;
}

.title-background {
	background-color: lime;
	border-radius: 5px;
}

.title-background h1 {
	color: white;
	text-align: center;
	padding: 4px;
}

#canvas-box {
	background-color: #F0F0F0;
	min-width: 100%;
	min-height: 100%;
	border-radius: 5px; 
}

#title-input {
	font-size: 22px;
	width: 99%;
	max-width: 99%;
	margin: 5px 5px 5px 5px;
	border: 0;
}

canvas {
	background: #fff;
	display: block;
	margin: 20px auto 10px;
	border-radius: 5px;
	cursor: url(../img/cursor.png), crosshair;
}

.socks-info {
	display: block;
	background-color: white;
	width: 360px;
	border-radius: 5px;
	border: 1px solid black;
	padding: 10px;
	margin: 10px auto;
}

.info-fields textarea {
	width: 340px;
	height: 140px;
	resize: none;
}

.controls {
	min-height: 60px;
	width: 300px;
	border-radius: 5px;
	border: 1px solid black;
	background-color: white;
	overflow: hidden;
	display: block;
	margin: 16px auto;
}

ul {
	list-style:none;
	margin: 0;
	float: 	left;
	padding: 10px 0 20px;
	width: 100%;
	text-align: center;
}

ul li, #newColor {
	display:block;
	height: 54px;
	width: 54px;
	border-radius: 60px;
	cursor: pointer;
	border: 0;
	box-shadow: 0 3px 0 0 #222;
}

ul li {
	display: inline-block;
	margin: 0 5px 10px;
}

.red {
	background: #fc4c4f;
}

.blue {
	background: #4fa3fc;
}

.yellow {
	background: #ECD13F;
}

.selected {
	border: 3px solid #D0D0D0;
	width: 54px;
	height: 54px;
}
/*button {
	background: #68B25B;
	box-shadow: 0 3px 0 0 #6A845F;
	color: #fff;
	outline: none;
	cursor: pointer;
	text-shadow: 0 1px #6A845F;
	display: block;
	font-size: 16px;
	line-height: 40px;
}*/
#revealColorSelect {
	border: none;
	border-radius: 5px;
	margin: 10px auto;
	display: block;
	width: 90px;
}

/* New Color Palette */
#colorSelect {
	background: #fff;
	border-radius: 5px;
	clear: both;
	margin: 20px auto 0;
	padding: 10px;
	width: 305px;
	position: relative;
		
	display:none;
}
#colorSelect:after {
	bottom: 100%;
	left: 50%;
	border: solid transparent;
	content: " ";
	height: 0;
	width: 0;
	position: absolute;
	pointer-events: none;
	border-color: rgba(255, 255, 255, 0);
	border-bottom-color: #fff;
	border-width: 10px;
	margin-left: -10px;
}

#newColor {
	width: 80px;
	height: 80px;
	border-radius: 3px;
	box-shadow: none;
	float: left;
	border: none;
	margin: 10px 20px 20px 10px;

}
.sliders p {
	margin: 8px 0;
	vertical-align: middle;
}
.sliders label {
	display: inline-block;
	margin: 0 10px 0 0;
	width: 35px;
	font-size: 14px;
	color: #6D574E;
}
.sliders input {
	position: relative;
	top: 2px;
}
#colorSelect button {
	border: none;
	border-top: 1px solid #6A845F;
	border-radius: 0 0 5px 5px;
	clear: both;
	margin: 10px -10px -7px;
	padding: 5px 10px;
	width: 325px;
}

#submit {
	width: 300px;
	margin: 0 auto;
	display: block;
}

#error {
	width: 300px;
	height: 40px;
	background: #FFC1C1;
	display: block;
	margin: 10px auto;
	text-align: center;
	border-radius: 5px;
	border: 1px solid #8B3626;
}

#error p {
	color: #8B3626;
	margin: 8px;
	display: block;
	font-size: 14px;
}


</style>

<div class="container">
		<div class="title-background">
			<h1 ng-click-"working()">Design a Sock</h1>
		</div>
		<div id="canvas-box">
			<input type="text" ng-model="title" id="title-input" placeholder="Give your socks a name!">
			<div class="row">			
				<div class="col-md-7">
					<canvas	width="600" height="600"></canvas>
				</div>
				<div class="col-md-5">
					<div class="socks-info">
						<div class="info-fields">
							<label>Description:</label><br>
							<textarea placeholder="Write a helpful description here, so people better the artistic ambitions that drove you to create your brillaint sock design!"></textarea><br>
							<label>Hashtags:</label><br>
							<textarea placeholder="Write tags so people can find your socks on the Sock Market! Separate each tag with a comma and space, and remember to include a hashtag (e.g., '#winter, #olympics')."></textarea>
						</div>
						<div class="controls">
							<ul>
								<li class="red selected"></li>
								<li class="blue"></li>
								<li class="yellow"></li>
							</ul>
							<button id="revealColorSelect" class="btn btn-primary">New Color</button>
							<!-- <button id="deleteSelectedColor" class="btn btn-primary">Delete Color</button> -->
							<div id="colorSelect">
								<span id="newColor"></span>
								<div class="sliders">
									<p>
										<label for="red">Red</label>
										<input id="red" name="red" type="range" min=0 max=255 value=0>
									</p>
									<p>
										<label for="green">Green</label>
										<input id="green" name="green" type="range" min=0 max=255 value=0>
									</p>
									<p>
										<label for="blue">Blue</label>
										<input id="blue" name="blue" type="range" min=0 max=255 value=0>
									</p>
								</div>
								<div>
								<button id="addNewColor" class="btn btn-primary">Add Color</button>
								</div>
							</div>
						</div>
						<button class="btn btn-primary" id="submit">Submit Your Design!</button>
						<div id="error">
							<p>(Error messages)</p>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

    <script src="http://code.jquery.com/jquery-1.11.0.min.js" type="text/javascript" charset="utf-8"></script>

<script>

console.log($("canvas"));

var color = $(".selected").css("background-color");
var context = $("canvas")[0].getContext("2d");
var $canvas = $("canvas");
var lastEvent;
var mouseDown = false;

var background = new Image();

function generateSockURL(){
  function generateRandomNumber() {
    return Math.floor(Math.random() * 3) + 1;
  }
  return './js/sock-bg/' + generateRandomNumber() + '.png';
}

background.src = generateSockURL();

background.onload = function() {
  context.drawImage(background, 0, 0);
};

//When clicking on control list items
  $(".controls").on("click", "li" , function(){
     //Deslect sibling elements
     $(this).siblings().removeClass("selected");
     //Select clicked element
     $(this).addClass("selected");
     //store the color
     color = $(this).css("background-color");
  });

//When "Add Color" button is pressed
  $("#revealColorSelect").click(function() {
  //Show color select or hide the color select
    changeColor();
  	$("#colorSelect").toggle();
  });

//Update the new color span
function changeColor(){
	var r = $("#red").val();
	var g = $("#green").val();
	var b = $("#blue").val();
	$("#newColor").css("background-color", "rgb(" + r + ", " + g + ", " + b + ")");
  //When color sliders change


}

$("input[type=range]").on("input", changeColor);

//when "Add Color" is pressed
$("#addNewColor").click(function(){
  //append the color to the controls ul
  var $newColor = $("<li></li>");
  $newColor.css("background-color", $("#newColor").css("background-color"));
  $(".controls ul").append($newColor);
  $(".controls li").siblings().removeClass("selected");
  $(".controls li").last().addClass("selected");
  color = $("#newColor").css("background-color");
  //when added, restore sliders and preview color to default
  $("#colorSelect").hide();
	var r = $("#red").val(0);
	var g = $("#green").val(0);
	var b = $("#blue").val(0);
	$("#newColor").css("background-color", "rgb(" + r + ", " + g + ", " + b + ")");

})

//On mouse events on the canvas
$canvas.mousedown(function(e){
  lastEvent = e;
  mouseDown = true;
}).mousemove(function(e){
  //draw lines
  if (mouseDown){
    context.beginPath();
    context.moveTo(lastEvent.offsetX,lastEvent.offsetY);
    context.lineTo(e.offsetX, e.offsetY);
    context.strokeStyle = color;
    context.stroke();
    context.lineCap = 'round';
    context.lineWidth = 20;

    lastEvent = e;
  }
}).mouseup(function(){
    mouseDown = false;
}).mouseleave(function(){
    $canvas.mouseup();
});

</script>